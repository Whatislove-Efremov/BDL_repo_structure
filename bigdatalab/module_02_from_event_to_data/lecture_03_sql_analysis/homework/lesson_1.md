# Урок 1: Основы SQL-анализа

## Обзор
Этот урок посвящен основным методам SQL-анализа, включая операции JOIN, фильтрацию с помощью предложений WHERE, группировку данных с помощью GROUP BY, использование предложений HAVING для фильтрации агрегатов, подзапросы для сложного получения данных и оконные функции для аналитических вычислений.

## Цели обучения
Студенты будут практиковать:
- Операции JOIN для соединения связанных таблиц
- Предложения WHERE для фильтрации данных
- GROUP BY для агрегации данных
- HAVING для фильтрации агрегированных данных
- Подзапросы для сложного получения данных
- Оконные функции для аналитических вычислений
- Комплексные аналитические запросы, объединяющие несколько концепций

## Задания
Выполните следующие SQL-упражнения, используя набор данных EcoMarket:

### Часть 1: Операции JOIN
- Отобразить для каждой продажи название продукта, категорию и адрес магазина

### Часть 2: Фильтрация WHERE
- Отобразить все магазины, расположенные в 'Poland'
- Отобразить транзакции с суммой продаж выше 1500 для продуктов класса B, отсортированные по номеру транзакции

### Часть 3: Агрегация GROUP BY
- Показать количество магазинов в каждой стране, отсортированное по количеству магазинов по убыванию

### Часть 4: Предложения HAVING
- Для каждого продукта показать общую сумму продаж и среднюю продажу, где общая сумма продаж превышает 400 000, отсортированную по общей сумме продаж по убыванию

### Часть 5: Подзапросы
- Показать имя и фамилию продавца, совершившего продажу с наибольшей стоимостью, и адрес магазина, в котором он работает

### Часть 6: Оконные функции
- Найти выручку всех немецких магазинов по месяцам и разницу с предыдущим месяцем, отсортированную по месяцам по возрастанию

### Часть 7: Комплексное аналитическое задание
- Для каждого магазина рассчитать агрегаты продаж и аналитические метрики по странам:
  - Количество продаж (COUNT(sales_id))
  - Общая сумма продаж (SUM(total_price))
  - Оставить только магазины с не менее чем 2 продажами
  - Рассчитать долю магазина от общей выручки страны
  - Присвоить ранг магазинам по сумме продаж внутри своей страны
  - Вычислить накопительную выручку по стране, отсортированную по убыванию выручки магазина
  - Отсортировать результаты по стране и рангу магазина